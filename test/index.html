<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>心理测试中心</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header class="site-header">
        <h1>心理测试中心</h1>
        <p class="subtitle">多维度能力测评平台（纯前端，无需登录）</p>
    </header>

    <main class="container">
        <section id="categories-section">
            <h2>测试分类</h2>
            <div id="categories-container" class="categories-container">
                <!-- 分类将通过JS动态生成 -->
            </div>
        </section>
        
        <section id="tests-section" class="hidden">
            <div class="category-header">
                <button id="back-to-categories" class="back-button">返回分类</button>
                <h2 id="current-category">测试列表</h2>
            </div>
            <ul id="test-list" class="test-list"></ul>
        </section>
    </main>

    <footer class="site-footer">
        <p>结果不上传服务器。可选择保存为图片至本地。</p>
    </footer>

    <script src="js/tests.js"></script>
    
    <!-- 预加载示例测试注册表（仅包含元数据，实际题库在 run.html 按需加载） -->
    <script src="data/iq.js"></script>
    <script src="data/eq.js"></script>
    <script src="data/iq60.js"></script>
    
    <script>
    (function() {
        // 定义测试分类
        var categories = {
            'psychology': {
                name: '心理测试',
                icon: '🧠',
                tests: [],
                description: '探索内心世界，了解自我性格特点和心理倾向的测试集合'
            },
            'knowledge': {
                name: '知识测试',
                icon: '📚',
                tests: [],
                description: '检验各领域知识储备，从历史到科学，全方位挑战你的知识面'
            },
            'iq': {
                name: '智力测试',
                icon: '💡',
                tests: [],
                description: '通过逻辑推理和模式识别，评估思维能力和解决问题的智力水平'
            },
            'eq': {
                name: '情商测试',
                icon: '❤️',
                tests: [],
                description: '测量情绪识别和人际交往能力，提升社交关系和自我情绪管理'
            },
            'personality': {
                name: '性格测试',
                icon: '🔍',
                tests: [],
                description: '揭示你的性格特质和行为模式，帮助更好地认识自己的优势和特点'
            },
            'career': {
                name: '职业倾向',
                icon: '💼',
                tests: [],
                description: '分析你的职业兴趣和能力特点，找到最适合的职业发展方向'
            }
        };
        
        // 根据ID分配测试到不同分类
        function categorizeTests(tests) {
            tests.forEach(function(test) {
                if (test.id.includes('iq')) {
                    categories.iq.tests.push(test);
                } else if (test.id.includes('eq')) {
                    categories.eq.tests.push(test);
                } else {
                    categories.psychology.tests.push(test);
                }
                
                // 添加题目数量属性
                if (!test.questionCount) {
                    // 默认题目数量，实际应从数据中获取
                    test.questionCount = test.id === 'iq60' ? 60 : 10;
                }
            });
        }
        
        // 渲染分类列表
        function renderCategories() {
            var container = document.getElementById('categories-container');
            
            Object.keys(categories).forEach(function(key) {
                // 显示所有分类，即使没有测试项目
                var category = categories[key];
                var card = document.createElement('div');
                card.className = 'category-card';
                card.dataset.category = key;
                
                var icon = document.createElement('div');
                icon.className = 'category-icon';
                icon.textContent = category.icon;
                
                var content = document.createElement('div');
                content.className = 'category-content';
                
                var title = document.createElement('h3');
                title.textContent = category.name;
                
                var desc = document.createElement('p');
                desc.className = 'category-desc';
                desc.textContent = category.description;
                
                var count = document.createElement('p');
                count.className = 'category-count';
                count.textContent = (category.tests.length > 0) ? 
                    category.tests.length + '个测试' : 
                    '即将推出';
                
                content.appendChild(title);
                content.appendChild(desc);
                content.appendChild(count);
                
                card.appendChild(icon);
                card.appendChild(content);
                container.appendChild(card);
                
                // 添加点击事件
                card.addEventListener('click', function() {
                    showTestsForCategory(key);
                });
            });
        }
        
        // 显示特定分类的测试
        function showTestsForCategory(categoryKey) {
            document.getElementById('categories-section').classList.add('hidden');
            document.getElementById('tests-section').classList.remove('hidden');
            document.getElementById('current-category').textContent = categories[categoryKey].name;
            
            renderTestList(categories[categoryKey].tests);
        }
        
        // 渲染测试列表
        function renderTestList(tests) {
            var list = document.getElementById('test-list');
            list.innerHTML = '';
            
            if (!tests.length) {
                var li = document.createElement('li');
                li.textContent = '该分类暂无测试';
                list.appendChild(li);
                return;
            }
            
            tests.forEach(function(item) {
                var li = document.createElement('li');
                var a = document.createElement('a');
                a.href = 'run.html?test=' + encodeURIComponent(item.id);
                
                var titleSpan = document.createElement('span');
                titleSpan.className = 'test-title';
                titleSpan.textContent = item.title;
                
                var infoSpan = document.createElement('span');
                infoSpan.className = 'test-info';
                infoSpan.textContent = item.questionCount + '题 · 约' + item.estimateMinutes + '分钟';
                
                a.appendChild(titleSpan);
                a.appendChild(infoSpan);
                li.appendChild(a);
                
                var p = document.createElement('p');
                p.className = 'desc';
                p.textContent = item.description;
                li.appendChild(p);
                list.appendChild(li);
            });
        }
        
        // 返回分类页面
        document.getElementById('back-to-categories').addEventListener('click', function() {
            document.getElementById('tests-section').classList.add('hidden');
            document.getElementById('categories-section').classList.remove('hidden');
        });
        
        // 初始化
        var all = window.TestRegistry ? window.TestRegistry.list() : [];
        categorizeTests(all);
        renderCategories();
    })();
    </script>
</body>
</html>



