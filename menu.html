<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menu</title>
    <link rel="stylesheet" href="menu.css">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
    <div class="navbar" id="navbar">
        <div class="logo" id="menu-logo"><a href="/"><b>âœ</b><h1>ğŸ“™ å°æœ¬æœ¬ãƒ»å¤‡å¿˜å½•</h1></a></div>
        <div class="menu-button" onClick="toggleMenu()">
            <span class="menu-icon" id="menu-icon">â˜°</span>
            <span id="menu-text">èœå•</span>
        </div>
    </div>
    <div class="overlay" id="overlay" onClick="toggleMenu()"></div>
    <div class="sidebar" id="sidebar"></div>

    <script>
        // åˆå§‹åŒ–èœå•å‡½æ•°
        function initMenu() {
            if (typeof menuData === 'undefined') {
                console.error('menuData is not defined');
                return;
            }
            
            // è®¾ç½®logo
            document.getElementById('menu-logo').textContent = menuData.logo;
            
            // æ„å»ºèœå•é¡¹
            const sidebar = document.getElementById('sidebar');
            menuData.menuItems.forEach((item, index) => {
                if (item.singleItem) {
                    // å•ä¸ªèœå•é¡¹
                    const div = document.createElement('div');
                    div.className = 'menu-item';
                    div.innerHTML = `<a href="${item.href}" class="${item.icon}">${item.text}</a>`;
                    sidebar.appendChild(div);
                } else {
                    // å¸¦å­èœå•çš„é¡¹
                    const submenuId = `submenu${index + 1}`;
                    
                    // ä¸»èœå•é¡¹
                    const menuItem = document.createElement('div');
                    menuItem.className = 'menu-item';
                    menuItem.setAttribute('onClick', `toggleSubmenu('${submenuId}')`);
                    menuItem.innerHTML = `${item.title} <span class="expand-icon">+</span>`;
                    sidebar.appendChild(menuItem);
                    
                    // å­èœå•
                    const submenu = document.createElement('div');
                    submenu.className = 'submenu';
                    submenu.id = submenuId;
                    submenu.style.display = 'block';
                    
                    item.items.forEach(subItem => {
                        const subMenuItem = document.createElement('div');
                        subMenuItem.className = 'menu-item';
                        subMenuItem.innerHTML = `<a href="${subItem.href}" class="${subItem.icon}">${subItem.text}</a>`;
                        submenu.appendChild(subMenuItem);
                    });
                    
                    sidebar.appendChild(submenu);
                }
            });
			
	
        }

        // èœå•äº¤äº’åŠŸèƒ½
        let isMenuOpen = false;
        let lastScrollY = window.scrollY;
        const navbar = document.getElementById('navbar');
        const menuText = document.getElementById('menu-text');
        const menuIcon = document.getElementById('menu-icon');
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('overlay');

        function toggleMenu() {
            sidebar.classList.toggle('open');
            overlay.style.display = isMenuOpen ? 'none' : 'block';
            menuIcon.textContent = isMenuOpen ? 'â˜°' : 'âœ–';
            menuText.textContent = isMenuOpen ? 'èœå•' : 'å…³é—­';
            isMenuOpen = !isMenuOpen;
        }

        function toggleSubmenu(submenuId) {
            const submenu = document.getElementById(submenuId);
            submenu.style.display = submenu.style.display === 'block' ? 'none' : 'block';
        }

        window.addEventListener('scroll', (event) => {
            if (!isMenuOpen) {
                const currentScrollY = window.scrollY;
                if (currentScrollY < lastScrollY) {
                    navbar.classList.remove('hidden');
                } else {
                    navbar.classList.add('hidden');
                }
                lastScrollY = currentScrollY;
            }
        });

        overlay.addEventListener('scroll', (event) => {
            event.stopPropagation();
        });

        // ç¡®ä¿æ•°æ®åŠ è½½ååˆå§‹åŒ–èœå•
        function checkDataAndInit() {
            if (typeof menuData !== 'undefined') {
                initMenu();
            } else {
                setTimeout(checkDataAndInit, 100);
            }
        }

        // å¼€å§‹æ£€æŸ¥æ•°æ®å¹¶åˆå§‹åŒ–
        checkDataAndInit();
    </script>
</body>
</html>